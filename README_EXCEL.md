# 📊 엑셀 기반 검색 실행 가이드

## 🎯 개요

엑셀 파일에 검색 조건을 작성하면 자동으로 여러 조건을 순차 실행합니다.

---

## 📋 엑셀 파일 작성

### 위치
```
configs/search_config.xlsx
```

### 구조

| 직무 | 지역 | 학력 | 나이 | 성별 | 구직상태 |
|------|------|------|------|------|----------|
| 제품영업 | 서울,경기 | 대졸,대학원 | 26-35 | 남 | 구직중 |
| 법인영업 | 강남구,서초구 | 대졸 | 30-40 | | 구직중,재직중 |
| IT·기술영업 | 성남시 분당구 | 대졸 | 28 | | |

### 작성 규칙

#### 1. **직무** (필수)
```
제품영업
백엔드개발자
IT·기술영업
```

#### 2. **지역** (선택)
- 광역: `서울`, `경기`
- 구/시: `강남구`, `성남시 분당구`
- 여러 개: `서울,경기,인천` (콤마로 구분)
- 빈칸: 전체

#### 3. **학력** (선택)
- 단일: `대졸`
- 여러 개: `대졸,대학원` (콤마로 구분)
- 가능한 값: `대졸`, `전문대`, `대학원`, `고졸`
- 빈칸: 전체

#### 4. **나이** (선택)
- 범위: `26-35` (26세~35세)
- 단일: `28` (정확히 28세)
- 빈칸: 전체

#### 5. **성별** (선택)
- 값: `남` 또는 `여`
- 빈칸: 전체

#### 6. **구직상태** (선택)
- 단일: `구직중`
- 여러 개: `구직중,재직중` (콤마로 구분)
- 가능한 값: `구직 준비중`, `구직중`, `재직중`
- 빈칸: 전체

---

## 🚀 실행 방법

### 1. 엑셀 파일 준비
```bash
configs/search_config.xlsx
```

### 2. 실행
```bash
python3 excel_runner.py
```

### 3. 결과 확인
```
output/
├── row2_제품영업_summary.json
├── row2_제품영업_결과.xlsx
├── row3_법인영업_summary.json
├── row3_법인영업_결과.xlsx
├── row4_IT·기술영업_summary.json
└── row4_IT·기술영업_결과.xlsx
```

---

## ⚙️ 고급 설정

`excel_runner.py` 파일의 설정을 변경할 수 있습니다:

```python
EXCEL_PATH = "configs/search_config.xlsx"  # 엑셀 경로
SHEET_NAME = None  # 시트명 (None이면 첫 번째 시트)

# 페이지 설정
START_PAGE = 1
END_PAGE = 1      # 페이지 수 조정
PAGE_SIZE = 100   # 페이지당 결과 수
DELAY = 1.0       # 지연 시간(초)
```

---

## 📝 여러 계정 사용

시트를 여러 개 만들어서 계정별로 관리:

```
search_config.xlsx
├── 시트1: account1@jobkorea.com
├── 시트2: account2@jobkorea.com
└── 시트3: account3@jobkorea.com
```

실행 시 시트명 지정:
```python
SHEET_NAME = "account1@jobkorea.com"
```

---

## 💡 팁

### 1. 빠른 테스트
```python
START_PAGE = 1
END_PAGE = 1
PAGE_SIZE = 10
```

### 2. 대량 수집
```python
START_PAGE = 1
END_PAGE = 10
PAGE_SIZE = 100
DELAY = 2.0  # 서버 부하 방지
```

### 3. 특정 행만 실행
엑셀에서 필요 없는 행은 삭제하거나 주석 처리

---

## ✅ 예시

### 예시 1: 강남권 제품영업 (구직중만)

| 직무 | 지역 | 학력 | 나이 | 성별 | 구직상태 |
|------|------|------|------|------|----------|
| 제품영업 | 강남구,서초구,송파구 | 대졸,대학원 | 26-35 | 남 | 구직중 |

### 예시 2: 판교 IT 개발자 (구직중+재직중)

| 직무 | 지역 | 학력 | 나이 | 성별 | 구직상태 |
|------|------|------|------|------|----------|
| 백엔드개발자 | 성남시 분당구 | 대졸 | 28-32 | | 구직중,재직중 |

### 예시 3: 서울 전체 금융영업 (전체)

| 직무 | 지역 | 학력 | 나이 | 성별 | 구직상태 |
|------|------|------|------|------|----------|
| 금융영업 | 서울 | 대졸,대학원 | 30-45 | | |

---

## 🔧 문제 해결

### Q1. 엑셀 파일을 찾을 수 없다고 나옵니다
```bash
mkdir -p configs
# 엑셀 파일을 configs/ 폴더에 넣으세요
```

### Q2. pandas 오류가 발생합니다
```bash
pip3 install pandas openpyxl --user --break-system-packages
```

### Q3. 직무를 찾을 수 없다고 나옵니다
- 직무명이 정확한지 확인
- 전체 카테고리에서 검색되므로 정확한 이름 사용
- 예: "제품영업", "백엔드개발자", "IT·기술영업"

---

## 📌 기본 main.py와 차이점

| 항목 | main.py | excel_runner.py |
|------|---------|-----------------|
| 설정 방식 | 코드 수정 | 엑셀 작성 |
| 여러 조건 | 한 번에 하나 | 여러 개 순차 실행 |
| 결과 파일명 | 고정 | 행 번호 + 직무명 |
| 사용 용도 | 단일 테스트 | 대량 검색 |

---

**이제 엑셀로 편하게 관리하세요!** 🎉
